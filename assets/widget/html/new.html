<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport"
          content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0"/>
    <title>编辑</title>
    <link rel="stylesheet" type="text/css" href="../css/api.css"/>
    <link rel="stylesheet" href="../css/aui.css">
    <link rel="stylesheet" href="../css/sm.css">
    <script src="../script/jquery.js"></script>
    <script src="../script/zepto.js"></script>
    <script src="../script/aui-toast.js"></script>
</head>
<body>
<div class="aui-searchbar" style="color: #000;position: fixed;z-index: 999999;background-color: #ffffff;">
    <div onclick="goBack()" style="height: 100%;width: 40px;padding-top: 8px;">
        <span class="aui-icon-left aui-iconfont"></span>
    </div>
    <div class="aui-title" style="width: 70%;text-align: center;">编辑</div>
    <div class="aui-list-item-label-icon" onclick="huixian(this)" style="width: 100%;height: 100%;padding-top: 8px;padding-left: 10px;" id="hx">
        <i class="aui-iconfont aui-icon-display" style="font-size: 1.3em;"></i>
    </div>
</div>
<div style="overflow-x: scroll;">
    <input type="hidden" id="uid">
    <ul class="aui-list aui-list-in" style="margin-top: 44px;margin-bottom: 47px;">
        <li class="aui-list-item">
            <div class="aui-list-item-center aui-row" style="width: 100%">
                <div class="aui-col-xs-5" style="margin-left: 30%;">
                    <img src="../image/img_addpic.png" style="margin: 2px;">
                </div>
                <div class="aui-col-xs-2" style="margin-left: 10px;margin-top: 6%;">
                    <i class="aui-iconfont aui-icon-star" style="font-size: 30px;color: rgba(8, 148, 236, 0.99);" id="shoucang" data-ok="1"></i>
                    <br>
                    <i class="aui-iconfont aui-icon-date" style="font-size: 30px;color: rgba(8, 148, 236, 0.99);" id="tixing" data-ok="1"></i>
                </div>
            </div>
        </li>
        <li class="aui-list-item">
            <div class="aui-list-item-label-icon">
                <i class="aui-iconfont aui-icon-pencil"></i>
            </div>
            <div class="aui-list-item-inner" style="width: 150px;">
                姓名
            </div>
            <div class="aui-list-item-inner" style=" width: 450px;">
                <div class="content">
                    <input type="text" id="xing_ming"
                           style="padding: 4px;border: solid 1px rgba(8, 148, 236, 0.39);border-radius: 10px;margin-top: 4px;height: 2.3em;width: 80%;"/>
                </div>
            </div>
        </li>
        <li class="aui-list-item">
            <div class="aui-list-item-label-icon">
                <i class="aui-iconfont aui-icon-hide"></i>
            </div>
            <div class="aui-list-item-inner" style="width: 150px;">
                性别
            </div>
            <div class="aui-list-item-inner" style=" width: 450px;line-height: 2.5em;">
                <div class="content">
                    <div style="width: 70px;float: left;">
                        <input type="radio" class="aui-radio" name="xing_bie" style="top: 10px;" value="男" checked/>男
                    </div>
                    <div>
                        <input type="radio" class="aui-radio" name="xing_bie" style="top: 10px;" value="女"/>女
                    </div>
                </div>
            </div>
        </li>
        <li class="aui-list-item">
            <div class="aui-list-item-label-icon">
                <i class="aui-iconfont aui-icon-like"></i>
            </div>
            <div class="aui-list-item-inner" style="width: 150px;">
                出生日期
            </div>
            <div class="aui-list-item-inner page" style=" width: 450px;background-color:rgba(255, 255, 255, 0);">
                <div class="aui-list-item-input content">
                    <input type="text" data-toggle='date' id="sheng_ri" onchange="get_xing_qi(this);get_nian_ling(this)"
                           style="margin-top: 4px;height: 2.3em;border: solid 1px rgba(8, 148, 236, 0.39);border-radius: 10px;width: 120px;display: initial;text-align: center"/>
                    <label id="sheng_ri_xing_qi" style="display: none;"></label>
                    <label id="nian_ling">0岁</label>
                </div>
            </div>
        </li>
        <li class="aui-list-item">
            <div class="aui-list-item-label-icon">
                <i class="aui-iconfont aui-icon-map"></i>
            </div>
            <div class="aui-list-item-inner" style="width: 150px;">
                出生地址
            </div>
            <div class="aui-list-item-inner" style=" width: 450px;">
                <div class="content">
                    <input type="text" id="jg"
                           style="padding: 4px;border: solid 1px rgba(8, 148, 236, 0.39);border-radius: 10px;margin-top: 4px;height: 2.3em;width: 80%;"/>
                </div>
            </div>
        </li>
        <li class="aui-list-item">
            <div class="aui-list-item-label-icon">
                <i class="aui-iconfont aui-icon-phone"></i>
            </div>
            <div class="aui-list-item-inner" style="width: 150px;">
                联系电话
            </div>
            <div class="aui-list-item-inner" style=" width: 450px;">
                <div class="content">
                    <input type="number" id="tel"
                           style="border: solid 1px rgba(8, 148, 236, 0.39);border-radius: 10px;margin-top: 4px;height: 2.3em;width: 80%;padding: 4px;"/>
                </div>
            </div>
        </li>
        <li class="aui-list-item">
            <div class="aui-list-item-label-icon">
                <i class="aui-iconfont aui-icon-qq"></i>
            </div>
            <div class="aui-list-item-inner" style="width: 150px;">
                QQ
            </div>
            <div class="aui-list-item-inner" style=" width: 450px;">
                <div class="content">
                    <input type="number" id="qq"
                           style="border: solid 1px rgba(8, 148, 236, 0.39);border-radius: 10px;margin-top: 4px;height: 2.3em;width: 80%;padding: 4px;"/>
                </div>
            </div>
        </li>
        <li class="aui-list-item">
            <div class="aui-list-item-label-icon">
                <i class="aui-iconfont aui-icon-wechat"></i>
            </div>
            <div class="aui-list-item-inner" style="width: 150px;">
                微信
            </div>
            <div class="aui-list-item-inner" style=" width: 450px;">
                <div class="content">
                    <input type="text" id="wechat"
                           style="border: solid 1px rgba(8, 148, 236, 0.39);border-radius: 10px;margin-top: 4px;height: 2.3em;width: 80%;padding: 4px;"/>
                </div>
            </div>
        </li>
        <li class="aui-list-item">
            <div class="aui-list-item-label-icon">
                <i class="aui-iconfont aui-icon-share"></i>
            </div>
            <div class="aui-list-item-inner" style="width: 150px;">
                家族关系
            </div>
            <div class="aui-list-item-inner" style=" width: 450px;">
                <div class="content">
                    <input type="text" id="jiazu"
                           style="padding: 4px;border: solid 1px rgba(8, 148, 236, 0.39);border-radius: 10px;margin-top: 4px;height: 2.3em;width: 80%;"/>
                </div>
            </div>
        </li>
        <li class="aui-list-item">
            <div class="aui-list-item-label-icon">
                <i class="aui-iconfont aui-icon-display"></i>
            </div>
            <div class="aui-list-item-inner" style="width: 150px;">
                兴趣爱好
            </div>
            <div class="aui-list-item-inner" style=" width: 450px;height: 10em;">
                <div class="content">
                    <textarea id="love"
                              style="padding: 4px;border: solid 1px rgba(8, 148, 236, 0.39);border-radius: 10px;height: 90%;width: 95%;"></textarea>
                </div>
            </div>
        </li>
        <li class="aui-list-item">
            <div class="aui-list-item-label-icon">
                <i class="aui-iconfont aui-icon-flag"></i>
            </div>
            <div class="aui-list-item-inner" style="width: 150px;">
                历史工作
            </div>
            <div class="aui-list-item-inner" style=" width: 450px;">
                <div class="content">
                    <input type="text" id="type"
                           style="border: solid 1px rgba(8, 148, 236, 0.39);border-radius: 10px;margin-top: 4px;height: 2.3em;width: 80%;padding: 4px;"/>
                </div>
            </div>
        </li>
        <li class="aui-list-item">
            <div class="aui-list-item-label-icon">
                <i class="aui-iconfont aui-icon-like"></i>
            </div>
            <div class="aui-list-item-inner" style="width: 150px;">
                工作特长
            </div>
            <div class="aui-list-item-inner" style=" width: 450px;">
                <div class="content">
                    <input type="text" id="tc"
                           style="border: solid 1px rgba(8, 148, 236, 0.39);border-radius: 10px;margin-top: 4px;height: 2.3em;width: 80%;padding: 4px;"/>
                </div>
            </div>
        </li>
        <li class="aui-list-item">
            <div class="aui-list-item-label-icon">
                <i class="aui-iconfont aui-icon-correct"></i>
            </div>
            <div class="aui-list-item-inner" style="width: 150px;">
                工作班次
            </div>
            <div class="aui-list-item-inner" style=" width: 450px;">
                <div class="content">
                    <input type="text" id="bc"
                           style="border: solid 1px rgba(8, 148, 236, 0.39);border-radius: 10px;margin-top: 4px;height: 2.3em;width: 80%;padding: 4px;"/>
                </div>
            </div>
        </li>
        <li class="aui-list-item">
            <div class="aui-list-item-label-icon">
                <i class="aui-iconfont aui-icon-laud"></i>
            </div>
            <div class="aui-list-item-inner" style="width: 150px;">
                领导级别
            </div>
            <div class="aui-list-item-inner" style=" width: 450px;">
                <div class="content">
                    <input type="text" id="lingdaojibie"
                           style="padding: 4px;border: solid 1px rgba(8, 148, 236, 0.39);border-radius: 10px;margin-top: 4px;height: 2.3em;width: 80%;"/>
                </div>
            </div>
        </li>
        <li class="aui-list-item">
            <div class="aui-list-item-label-icon">
                <i class="aui-iconfont aui-icon-calendar"></i>
            </div>
            <div class="aui-list-item-inner" style="width:150px;">
                预约日期
            </div>
            <div class="aui-list-item-inner page" style=" width: 450px;background-color:rgba(255, 255, 255, 0);">
                <div class="aui-list-item-input content">
                    <input type="text" data-toggle='date' id="date" onchange="get_xing_qi(this)"
                           style="width: 120px;display: initial;border: solid 1px rgba(8, 148, 236, 0.39);border-radius: 10px;margin-top: 4px;height: 2.3em;text-align: center;"/>
                    <label id="xq"></label>
                </div>
            </div>
        </li>
        <li class="aui-list-item">
            <div class="aui-list-item-label-icon">
                <i class="aui-iconfont aui-icon-date"></i>
            </div>
            <div class="aui-list-item-inner" style="width: 150px;">
                预约时间
            </div>
            <div class="aui-list-item-inner" style=" width: 450px;">
                <div class="content">
                    <input type="text" id="sj" onclick="szShow(document.body,szsj)"
                           style="height: 2.3em;width: 120px;margin-top: 4px;text-align: center;border: solid 1px rgba(8, 148, 236, 0.39);border-radius: 10px;"
                           readonly/>
                </div>
            </div>
        </li>
        <li class="aui-list-item">
            <div class="aui-list-item-label-icon">
                <i class="aui-iconfont aui-icon-location"></i>
            </div>
            <div class="aui-list-item-inner" style="width: 150px;">
                预约地点
            </div>
            <div class="aui-list-item-inner" style=" width: 450px;">
                <div class="content">
                    <input type="text" id="dd"
                           style="border: solid 1px rgba(8, 148, 236, 0.39);border-radius: 10px;margin-top: 4px;height: 2.3em;width: 80%;padding: 4px;"/>
                </div>
            </div>
        </li>
        <li class="aui-list-item">
            <div class="aui-list-item-label-icon">
                <i class="aui-iconfont aui-icon-cert"></i>
            </div>
            <div class="aui-list-item-inner" style="width: 150px;">
                预约事宜
            </div>
            <div class="aui-list-item-inner" style=" width: 450px;">
                <div class="content">
                    <input type="text" id="bt"
                           style="border: solid 1px rgba(8, 148, 236, 0.39);border-radius: 10px;margin-top: 4px;height: 2.3em;width: 80%;padding: 4px;"/>
                </div>
            </div>
        </li>
        <li class="aui-list-item">
            <div class="aui-list-item-label-icon">
                <i class="aui-iconfont aui-icon-comment"></i>
            </div>
            <div class="aui-list-item-inner" style="width: 150px;">
                预约内容
            </div>
            <div class="aui-list-item-inner" style=" width: 450px;height: 10em;">
                <div class="content">
                    <textarea id="nr"
                              style="padding: 4px;border: solid 1px rgba(8, 148, 236, 0.39);border-radius: 10px;height: 90%;width: 95%;"></textarea>
                </div>
            </div>
        </li>
    </ul>
</div>
<footer class="aui-bar aui-bar-tab aui-tab" id="tab" style="min-height: 45px;z-index: 9999">
    <div class="aui-bar-tab-item aui-active" style="height: 1rem;" onclick="saveAllData()">
        <i class="aui-iconfont aui-icon-correct"></i>
        <p style="margin: 0;">保存</p>
    </div>
    <div class="aui-bar-tab-item" style="height: 1rem;" onclick="shoucang()">
        <i class="aui-iconfont aui-icon-star"></i>
        <p style="margin: 0;">收藏</p>
    </div>
    <div class="aui-bar-tab-item" style="height: 1rem;" onclick="tixing()">
        <i class="aui-iconfont aui-icon-date"></i>
        <p style="margin: 0;">提醒</p>
    </div>
    <div class="aui-bar-tab-item" style="height: 1rem;" onclick="quxiao()">
        <i class="aui-iconfont aui-icon-close"></i>
        <p style="margin: 0;">取消</p>
    </div>
</footer>
</body>
<script type="text/javascript" src="../script/api.js"></script>
<script src="../script/sm.js"></script>
<script src="../script/time.js"></script>
<script>
    Date.prototype.Format = function (formatStr) {
        var str = formatStr;
        str = str.replace(/yyyy|YYYY/, this.getFullYear());
        str = str.replace(/MM/, (this.getMonth() + 1) > 9 ? (this.getMonth() + 1).toString() : '0' + (this.getMonth() + 1));
        str = str.replace(/dd|DD/, this.getDate() > 9 ? this.getDate().toString() : '0' + this.getDate());
        str = str.replace(/hh|HH/, this.getHours() > 9 ? this.getHours().toString() : '0' + this.getHours());
        str = str.replace(/mm/, (this.getMinutes() + 1) > 9 && (this.getMinutes() + 1) <= 59 ? (this.getMinutes() + 1).toString() : ((this.getMinutes() + 1) <= 59 ? ('0' + (this.getMinutes() + 1)) : (this.getMinutes())));
        str = str.replace(/ss|SS/, this.getSeconds() > 9 ? this.getSeconds().toString() : '0' + this.getSeconds());
        return str;
    };
    function shoucang() {
        if ($('#shoucang').hasClass('aui-icon-star')) {
            $('#shoucang').removeClass('aui-icon-star');
            $('#shoucang').attr('data-ok', 0);
        } else {
            $('#shoucang').addClass('aui-icon-star');
            $('#shoucang').attr('data-ok', 1);
        }
    }
    function tixing() {
        if ($('#tixing').hasClass('aui-icon-date')) {
            $('#tixing').removeClass('aui-icon-date');
            $('#tixing').attr('data-ok', 0);
        } else {
            $('#tixing').addClass('aui-icon-date');
            $('#tixing').attr('data-ok', 1);
        }
    }
    function quxiao() {
        if (confirm("确认取消？")) {
            goBack();
        }
    }
    function szsj(s, f) {
        $('#sj').val(s + ':' + f);
    }
    /**
     * 初始化日期
     */
    function init() {
        var date = new Date();
        $('#sj').val(date.Format('HH:mm'));
        $('#date').val(date.Format("yyyy-MM-dd"));
        get_xing_qi($('#date'));
    }
    /**
     * 计算星期
     */
    function get_xing_qi(obj) {
        var w = "日一二三四五六".charAt(new Date($(obj).val()).getDay());
        $(obj).next().html("星期" + w).data('xingqi', w);
    }
    /**
     * 计算年龄
     */
    function get_nian_ling(obj) {
        var q = parseInt(new Date($(obj).val()).Format("yyyy"));
        var x = parseInt(new Date().Format("yyyy"));
        if (parseInt(new Date($(obj).val()).Format("MMDD")) > parseInt(new Date().Format("MMDD"))) {
            $('#nian_ling').html((((x - q) - 1) < 0 ? 0 : ((x - q) - 1)) + '岁');
        } else {
            $('#nian_ling').html((((x - q) - 1) < 0 ? 0 : ((x - q) - 1)) + '岁');
        }
    }
    var db = null;
    apiready = function () {
        db = api.require('db');
        db.isOpen = false;
        window.ApiUtil = api.require('ApiUtil');
        api.addEventListener({
            name: 'keyback'
        }, function (ret, err) {
            return false;
        });
        var pageParam = api.pageParam;
        console.log('....................................pageParam:' + JSON.stringify(pageParam));
        if (pageParam.type == 'info') {
            $('input[type=radio]:checked').hide();
            $('input[type=radio]').not(':checked').parent().hide();
            $('input[type!=radio],textarea').attr('Disabled', true).css({
                'border': 'solid 1px rgba(163, 174, 182, 0.388235)'
            });
            openDB(function (ret) {
                setTimeout(function () {
                    if (ret) {
                        if (db.isOpen) {
                            var sql = 'SELECT * FROM contacts where id= "' + pageParam.id + '"';
                            selectDB(sql, function (res, ret) {
                                if (res && ret.status) {
                                    console.log(JSON.stringify(ret));
                                    if (ret.data.length > 0) {
                                        var user = ret.data[0];
                                        $('#uid').val(user.id);
                                        $('#xing_ming').val(user.name);//姓名
                                        if (user.sex == '男') {
                                            console.log("男");
                                            $('input[value=男]').click().parent().show();
                                            $('input[value=女]').parent().hide();
                                        } else {
                                            console.log("女");
                                            $('input[value=女]').click().parent().show();
                                            $('input[value=男]').parent().hide();
                                        }
                                        $('#sheng_ri').val(user.birthday);//生日
										if(user.birthday){
										   $('#sheng_ri').change();
										}
                                        $('#jg').val(user.address);//籍贯
                                        $('#tel').val(user.phone);//电话
                                        $('#qq').val(user.qq);//qq
                                        $('#wechat').val(user.wechar);//微信
                                        $('#jiazu').val(user.relation);//家族关系
                                        $('#love').val(user.love);//爱好
                                        $('#type').val(user.job);//历史工作
                                        $('#bc').val(user.shift);//工作班次
                                        $('#tc').val(user.speciality);//特长
                                        $('#lingdaojibie').val(user.level);//领导级别
                                        $('#date').val(user.subDate);//预约日期
                                        $('#sj').val(user.subTime);//预约时间
                                        $('#dd').val(user.subAddress);//预约地点
                                        $('#bt').val(user.subEvent);//预约标题
                                        $('#nr').val(user.subContent);//预约内容
                                        if (user.isCollect == '1') {
                                            $('#shoucang').addClass('aui-icon-star');
                                            $('#shoucang').attr('data-ok', 1);
                                        } else {
                                            $('#shoucang').removeClass('aui-icon-star');
                                            $('#shoucang').attr('data-ok', 0);
                                        }
                                        if (user.isRemind == '1') {
                                            $('#tixing').addClass('aui-icon-date');
                                            $('#tixing').attr('data-ok', 1);
                                        } else {
                                            $('#tixing').removeClass('aui-icon-date');
                                            $('#tixing').attr('data-ok', 0);
                                        }
                                    }
                                }
                            })
                        }
                    }
                }, 1000);
            });
        }
    };
    function goBack() {
        api.closeWin({
            name: 'new'
        });
    }
    init();
    Zepto.init();
    /**
     * 编辑与查看
     */
    function huixian(obj) {
        if ($('input[type=radio]:checked').is(':hidden')) {
            $('input[type=radio]').show();
            $('input[type=radio]').not(':checked').parent().show();
            $('input[type!=radio],textarea').css({
                'border': 'solid 1px rgba(8, 148, 236, 0.39)'
            }).attr('Disabled', false);
            $(obj).find('i').removeClass('aui-icon-hide');
            $(obj).find('i').addClass('aui-icon-display');
        } else {
            $('input[type=radio]:checked').hide();
            $('input[type=radio]').not(':checked').parent().hide();
            $('input[type!=radio],textarea').attr('Disabled', true).css({
                'border': 'solid 1px rgba(163, 174, 182, 0.388235)'
            });
            $(obj).find('i').removeClass('aui-icon-display');
            $(obj).find('i').addClass('aui-icon-hide');
        }
    }
    /**
     * 保存数据
     */
    function saveAllData() {
        var user = {};
        user.name = $('#xing_ming').val() || null;//姓名
        user.sex = $('input[name="xing_bie"]:checked').val() || null;//性别
        user.birthday = $('#sheng_ri').val() || null;//生日
        user.address = $('#jg').val() || null;//籍贯
        user.phone = $('#tel').val() || null;//电话
        user.qq = $('#qq').val() || null;//qq
        user.wechar = $('#wechat').val() || null;//微信
        user.relation = $('#jiazu').val() || null;//家族关系
        user.love = $('#love').val() || null;//爱好
        user.job = $('#type').val() || null;//历史工作
        user.shift = $('#bc').val() || null;//工作班次
        user.speciality = $('#tc').val() || null;//特长
        user.level = $('#lingdaojibie').val() || null;//领导级别
        user.subDate = $('#date').val() || null;//预约日期
        user.subTime = $('#sj').val() || null;//预约时间
        user.subAddress = $('#dd').val() || null;//预约地点
        user.subEvent = $('#bt').val() || null;//预约标题
        user.subContent = $('#nr').val() || null;//预约内容
        user.isCollect = $('#shoucang').attr('data-ok');
        user.isRemind = $('#tixing').attr('data-ok');
        if (!confirm("确认保存？")) {
            return;
        }
        ApiUtil.Toast({
            type: "loading",
            isHide: "false"
        });
        openDB(function (ret) {
            if (ret) {
                setTimeout(function () {
                    if (db.isOpen) {
                        var sql = 'SELECT * FROM contacts where name = "' + user.name + '" or phone = "' + user.phone + '"';
                        ApiUtil.log({tag: '根据名字和手机号查询', message: sql});
                        console.log('sql:' + sql);
                        selectDB(sql, function (res, ret) {
                            if (res && ret.status) {
                                console.log(JSON.stringify(ret));
                                if (ret.data.length == 0) {
                                    var k = '';
                                    var v = '';
                                    for (var key in user) {
                                        k += key + ',';
                                        if (user[key]) {
                                            v += '"' + user[key] + '",';
                                        } else {
                                            v += user[key] + ',';
                                        }
                                    }
                                    k = k.substring(0, k.length - 1);
                                    v = v.substring(0, v.length - 1);
                                    var sql = 'insert into contacts(' + k + ') values(' + v + ')';
                                    ApiUtil.log({tag: '插入新记录', message: sql});
                                    console.log(sql);
                                    insertDB(sql, function (res, ret) {
                                        if (res) {
                                            setTimeout(function () {
                                                ApiUtil.Toast({
                                                    type: "success",
                                                    isHide: "false"
                                                });
                                                setTimeout(function () {
                                                    ApiUtil.Toast({
                                                        type: "success",
                                                        isHide: "true"
                                                    });
                                                    goBack();
                                                }, 500);
                                            }, 200);
                                        }
                                        console.log(JSON.stringify(ret));
                                    });
                                } else {
                                    setTimeout(function () {
                                        if (confirm("存在相同数据，是否更新？")) {
                                            var s = '';
                                            for (var key in user) {
                                                if (!user[key]) {
                                                    s += key + '=' + user[key] + ',';
                                                } else {
                                                    s += key + '="' + user[key] + '",';
                                                }
                                            }
                                            s = s.substring(0, s.length - 1);
                                            console.log(s);
                                            var sql = 'update contacts set ' + s + ' where id=' + $('#uid').val();
                                            console.log(sql);
											 ApiUtil.log({tag: '修改记录', message: sql});
                                            insertDB(sql, function (res, ret) {
                                                console.log(JSON.stringify(ret));
                                                if (res) {
                                                    setTimeout(function () {
                                                        ApiUtil.Toast({
                                                            type: "success",
                                                            isHide: "false"
                                                        });
                                                        setTimeout(function () {
                                                            ApiUtil.Toast({
                                                                type: "success",
                                                                isHide: "true"
                                                            });
                                                            goBack();
                                                        }, 500);
                                                    }, 200);
                                                } else {
                                                    setTimeout(function () {
                                                        ApiUtil.Toast({
                                                            type: "fail",
                                                            isHide: "false"
                                                        });
                                                        setTimeout(function () {
                                                            ApiUtil.Toast({
                                                                type: "fail",
                                                                isHide: "true"
                                                            });
                                                        }, 100);
                                                    }, 200);
                                                }
                                            });
                                        }
                                    }, 200);
                                }
                            } else {
                                setTimeout(function () {
                                    ApiUtil.Toast({
                                        type: "fail",
                                        isHide: "false"
                                    });
                                    setTimeout(function () {
                                        ApiUtil.Toast({
                                            type: "fail",
                                            isHide: "true"
                                        });
                                    }, 100);
                                }, 200);
                                console.log(JSON.stringify(ret));
                            }
                        });
                    }
                }, 200);
            } else {
                setTimeout(function () {
                    ApiUtil.Toast({
                        type: "fail",
                        isHide: "false"
                    });
                    setTimeout(function () {
                        ApiUtil.Toast({
                            type: "fail",
                            isHide: "true"
                        });
                    }, 100);
                }, 200);
            }
        });
    }
    function openDB(callback) {
        db.openDatabase({
            name: 'contact'
        }, function (ret, err) {
            if (ret.status) {
                db.isOpen = true;
                ApiUtil.log({tag: 'openDatabase', message: ret});
                callback(true);
            } else {
                ApiUtil.log({tag: 'openDatabase', message: err});
                db.isOpen = false;
                callback(false);
            }
        });
    }
    function selectDB(sql, callback) {
        db.selectSql({
            name: 'contact',
            sql: sql
        }, function (ret, err) {
            if (ret.status) {
                //alert(JSON.stringify(ret));
                callback(true, ret);
            } else {
                //alert(JSON.stringify(err));
                callback(false, err);
            }
        });
    }
    function insertDB(sql, callback) {
        db.executeSql({
            name: 'contact',
            sql: sql
        }, function (ret, err) {
            if (ret.status) {
                //alert(JSON.stringify(ret));
                callback(true, ret);
            } else {
                //alert(JSON.stringify(err));
                callback(false, err);
            }
        });
    }
</script>
</html>
